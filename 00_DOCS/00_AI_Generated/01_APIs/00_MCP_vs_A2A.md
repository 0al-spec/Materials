# MCP vs A2A

Кратко: Model Context Protocol (MCP) от Anthropic и Agent‑to‑Agent (A2A) от Google + Microsoft — оба открытые стандарты для «внешней нервной системы» ИИ, но решают разные уровни задачи.  
MCP называют «USB‑C для моделей»: он связывает один LLM с локальными данными и инструментами (JSON‑RPC).  
A2A ‑‑ это «TCP/IP для агентов»: gRPC‑протокол, по которому самостоятельные агенты из разных облаков обмениваются целями и координируют действия.

---

## 1. Общие черты

| Характеристика                        | Как проявляется                                                                 |
|--------------------------------------|---------------------------------------------------------------------------------|
| Открытый стандарт + Apache/MIT лицензии | MCP — MIT / Apache‑2, A2A — Apache‑2                                           |
| Модель‑ и вендор‑агностичность       | Обе спецификации декларируют работу «с любым фреймворком»                     |
| Цель — устранить интеграционную фрагментацию | MCP: «подключи данные один раз»; A2A: «агенты разных облаков работают вместе» |
| Активное сообщество и SDK            | MCP‑SDK (Py/TS/Rust); A2A‑SDK (Go/Rust/JS)                                     |

---

## 2. Различия по слоям стека

### 2.1 Задача и объект коммуникации

- **MCP** — «модель ↔ ресурс/инструмент»  
  ЛЛМ исполняет tool‑call на MCP‑сервере и получает результат (файл, SQL, код).

- **A2A** — «агент ↔ агент»  
  Один автономный агент передаёт другому тройку Goal / Action / Result для координации.

### 2.2 Транспорт и формат

| Слой           | MCP                                  | A2A                                         |
|----------------|---------------------------------------|----------------------------------------------|
| RPC            | JSON‑RPC 2.0 over Unix‑socket / HTTP | gRPC (HTTP/2) + protobuf‑схемы              |
| Авторизация    | Token‑подпись (Auth v1.1)             | mTLS + OAuth2 / SPIFFE SVID                 |
| Событийность   | «Запрос‑ответ»; стрим — экспериментально | Bidirectional streaming встроен в gRPC  |

### 2.3 Семантика данных

- **MCP**: Resource (файл/URL/DB) + Tool (функция).  
  Модель описывает контекст и cap‑схему прав доступа перед вызовом.

- **A2A**: GoalRequest → агент выбирает Action → возвращает Result;  
  ведётся журнал AuditTrail.

### 2.4 Сценарии использования

| MCP (внутри агента/ОС)                   | A2A (между агентами)                                               |
|------------------------------------------|--------------------------------------------------------------------|
| LLM читает GitHub‑репо и делает PR       | Табличный‑агент запрашивает Vision‑агента в другом облаке         |
| Обработка PDF через локальный OCR‑tool   | Календарный агент синхронизирует задачи между SAP и Salesforce    |

### 2.5 Зрелость и поддержка

| Метрика           | MCP                                   | A2A                                           |
|-------------------|----------------------------------------|-----------------------------------------------|
| Дата релиза       | Ноябрь 2024                            | Апрель 2025                                   |
| Кто рулит         | Anthropic (single‑vendor)              | Консорциум Google + Microsoft (+ > 50 партнёров) |
| Проекты‑адоптеры  | Replit, Codeium, Sourcegraph           | Salesforce, Oracle, SAP                       |
| Риски             | Перекрывают API, требуют Cap‑Tokens   | Сложность PKI, гетерогенная инфраструктура    |

---

## 3. Когда какой протокол использовать

| Ситуация                                                           | Предпочтителен                                                                              |
|--------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
| Связать LLM с локальной БД, файловой системой или Python‑скриптом | **MCP** — меньше накладных расходов; понятная token‑авторизация                             |
| Оркестрация агентов из разных облаков/языков                       | **A2A** — встроенный discovery, потоковые Goal‑updates, корпоративный IAM                  |
| Внутри одного устройства (Agent‑OS)                                | **MCP** как «внутренний ABI»; сверху — шлюз MCP→A2A для внешнего мира                     |
| Корпоративный B2B‑интеграционный слой                              | **A2A** — поддержка SPIFFE‑mTLS, согласованный audit‑trail                                 |

---

## 4. Итоговая таблица отличий

| Аспект             | MCP                                      | A2A                                                  |
|--------------------|-------------------------------------------|-------------------------------------------------------|
| Уровень            | Модель ↔ Инструмент/Данные                | Агент ↔ Агент                                        |
| Транспорт          | JSON‑RPC over HTTP/Unix                   | gRPC (HTTP/2)                                        |
| Auth               | Token, optional OAuth                     | mTLS + OAuth2/SPIFFE                                 |
| Основные сущности  | Resource, Tool, Prompt                    | Goal, Action, Result                                 |
| Запуск             | Локальный сокет, легковесный              | Облако/сеть, потоковый                               |
| Владение стандартом| Anthropic                                 | Google + Microsoft (консорц.)                        |
| Типовые кейсы      | LLM‑код‑в‑редакторе, файловый доступ      | Кросс‑облачная координация, B2B‑агенты               |
